# Connection Pool

커넥션 풀은 데이터베이스와 연결을 효율적으로 관리하기 위해 **미리 일정 수의 데이터베이스 연결을 생성**해 두고, **애플리케이션에서 필요할 때마다 이를 재사용**하도록 하는 기술이다. 데이터베이스와의 연결은 비용이 많이 드는 작업이기 때문에, 커넥션 풀을 사용하면 애플리케이션의 성능을 크게 향상시킬 수 있다.

일반적으로 데이터베이스에 연결하기 위해서는 다음과 같은 과정이 필요하다.

1. 데이터베이스 드라이버 로드
2. 데이터베이스 서버와 네트워크 연결
3. 데이터베이스 인증
4. 세션 생성 및 설정

위 과정은 상대적으로 시간이 많이 걸리며, 서버에 부하를 줄 수 있다. 특히 다중 사용자 환경에서 이러한 연결 작업이 빈번하게 일어나면, 서버 성능이 크게 저하될 수 있다. 커넥션 풀은 이 문제를 해결하기 위해 탄생한 개념으로, 애플리케이션이 시작할 때 일정 수의 데이터베이스 연결을 미리 생성해 둔다. 이때, 이 풀에 있는 연결들은 애플리케이션에서 사용될 준비가 되어 있으며, 다음과 같은 방식으로 작동한다.

1. **연결 요청**: 애플리케이션이 데이터베이스에 연결이 필요할 때, 커넥션 풀에서 사용 가능한 연결을 요청한다.
2. **연결 할당**: 커넥션 풀은 사용 가능한 연결 중 하나를 애플리케이션에 할당한다.
3. **연결 사용**: 애플리케이션은 할당된 연결을 사용하여 데이터베이스 작업을 수행한다.
4. **연결 반환**: 작업이 완료되면, 연결을 닫지 않고 커넥션 풀에 반환하여 재사용할 수 있도록 한다.
5. **연결 유지 및 관리**: 커넥션 풀은 일정 시간이 지나거나 연결에 문제가 발생할 경우, 해당 연결을 닫고 새 연결을 생성하여 풀을 유지 관리한다.

## Advantages

- **성능 향상**: 연결 생성 및 종료 비용을 줄여 성능을 크게 향상시킬 수 있다.
- **자원 관리**: 제한된 수의 연결만 유지하므로, 데이터베이스 서버의 리소스를 효율적으로 관리할 수 있다.
- **확장성**: 다수의 사용자가 동시에 데이터베이스에 접근해도 효율적으로 처리할 수 있어 확장성이 높아진다.

## Components and Settings

커넥션 풀은 다양한 설정을 통해 최적화 할 수 있다. 

- **초기 커넥션 수 (Initial Pool Size)**: 애플리케이션이 시작될 때, 미리 생성할 연결의 수를 설정한다.
- **최대 커넥션 수 (Max Pool Size)**: 풀에서 유지할 수 있는 최대 연결 수를 설정한다. 사용량이 많아질 때 풀의 크기를 늘려야 하지만, 이 값을 초과하지 않는다.
- **최소 커넥션 수 (Min Pool Size)**: 풀에서 유지할 최소 연결 수를 설정한다. 사용량이 줄어들 때도 이 수만큼의 연결은 항상 유지된다.
- **커넥션 유효 시간 (Max Idle Time)**: 일정 시간 동안 사용되지 않은 연결을 닫아 자원을 절약할 수 있다.
- **대기 시간 (Connection Wait Time)**: 풀에 사용 가능한 연결이 없을 때, 새로운 연결이 생길 때까지 대기할 시간이다.
- **검사 쿼리 (Validation Query)**: 풀에 있는 연결이 유효한지 확인하기 위해 주기적으로 실행할 SQL 쿼리이다. 이 쿼리를 통해 죽어 있는 연결을 식별하고 제거할 수 있다.
